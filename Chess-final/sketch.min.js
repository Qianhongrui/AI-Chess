var test,temp,moving=!1,tileSize=100,movingPiece,whitesMove=!0,moveCounter=10,images=[],whiteAI=!0,blackAI=!1,depthPara,depthPlus,depthMinus,tempMaxDepth=10,strat_button=!1,input_piece=!1,input,initiative,gote,greeting,twoP,rule,inputPiece,setPiece,steps=1;
function setup(){createCanvas(400,400);htmlStuff();print("Start game!");inputPiece=createElement("h2","Input specific pieces: ");inputPiece.position(500,20);input=createInput("AB+YCZ+BCZCX+Z+Y");input.position(500,80);setPiece=createButton("Submit");setPiece.position(650,80);setPiece.mousePressed(SetPiece);initiative=createButton("Initiative");initiative.position(500,180);initiative.mousePressed(Initiative);gote=createButton("Gote ");gote.position(600,180);gote.mousePressed(Gote);twoP=createButton("TwoP ");
twoP.position(680,180);twoP.mousePressed(TwoP);greeting=createElement("h2","Initiative or Gote?");greeting.position(500,100);rule=createElement("h3","(Rule: A>>XY, B>>YZ, C>>ZX; X>>AB, Y>>BC, Z>>CA)");rule.position(500,130);for(var a=1;7>a;a++)images.push(loadImage("assets/"+a+".png"))}function Initiative(){whiteAI=!1;blackAI=!0;gote.hide();twoP.hide();strat_button=!0}function Gote(){whiteAI=!0;blackAI=!1;initiative.hide();twoP.hide();strat_button=!0}
function TwoP(){blackAI=whiteAI=!0;initiative.hide();gote.hide();strat_button=!0}function SetPiece(){input_piece=!0;test=new Board}function draw(){background(100);showGrid();input_piece&&(test.show(),strat_button&&20>=steps&&runAIs())}
function runAIs(){maxDepth=tempMaxDepth;if(!test.isDead()&&!test.hasWon()){if(blackAI&&!whitesMove)if(0>moveCounter){temp=test;test=maxFunAB(test,-400,400,0);for(var a=0;4>a;a++)for(var b=0;4>b;b++){if(temp.getPieceAt(a,b)&&!temp.getPieceAt(a,b).white&&null==test.getPieceAt(a,b)&&temp.getPieceAt(a,b))switch(temp.getPieceAt(a,b).letter){case "K":print("Steps: ",steps);print("blackMove: X move fm:",a,b);steps++;break;case "R":print("Steps: ",steps);print("blackMove: Y move fm:",a,b);steps++;break;case "P":print("Steps: ",
steps),print("blackMove: Z move fm:",a,b),steps++}if((null==temp.getPieceAt(a,b)||temp.getPieceAt(a,b).white)&&test.getPieceAt(a,b)&&!test.getPieceAt(a,b).white&&test.getPieceAt(a,b))switch(test.getPieceAt(a,b).letter){case "K":print("blackMove: X move to:",a,b);break;case "R":print("blackMove: Y move to:",a,b);break;case "P":print("blackMove: Z move to:",a,b)}}whitesMove=!0;moveCounter=10}else moveCounter--;if(whiteAI&&whitesMove)if(0>moveCounter){temp=test;test=minFunAB(test,-400,400,0);for(a=0;4>
a;a++)for(b=0;4>b;b++){if(temp.getPieceAt(a,b)&&temp.getPieceAt(a,b).white&&null==test.getPieceAt(a,b)&&temp.getPieceAt(a,b))switch(temp.getPieceAt(a,b).letter){case "K":print("Steps: ",steps);print("whiteMove: A move fm:",a,b);steps++;break;case "R":print("Steps: ",steps);print("whiteMove: B move fm:",a,b);steps++;break;case "P":print("Steps: ",steps),print("whiteMove: C move fm:",a,b),steps++}if((null==temp.getPieceAt(a,b)||!temp.getPieceAt(a,b).white)&&test.getPieceAt(a,b)&&test.getPieceAt(a,b).white&&
test.getPieceAt(a,b))switch(test.getPieceAt(a,b).letter){case "K":print("whiteMove: A move to:",a,b);break;case "R":print("whiteMove: B move to:",a,b);break;case "P":print("whiteMove: C move to:",a,b)}}whitesMove=!1;moveCounter=10}else moveCounter--}}function showGrid(){for(var a=0;4>a;a++)for(var b=0;4>b;b++)1==(a+b)%2?fill(0):fill(240),noStroke(),rect(a*tileSize,b*tileSize,tileSize,tileSize)}var tempx,tempy;
function mousePressed(){var a=floor(mouseX/tileSize),b=floor(mouseY/tileSize);if(input_piece&&strat_button&&!test.isDone()){if(moving)movingPiece.canMove(a,b,test)?(movingPiece.move(a,b,test),print("Steps: ",steps),steps++,"K"==movingPiece.letter&&whitesMove&&(print("whiteMove: A move fm:",tempx,tempy),print("whiteMove: A move to:",a,b)),"R"==movingPiece.letter&&whitesMove&&(print("whiteMove: B move fm:",tempx,tempy),print("whiteMove: B move to:",a,b)),"P"==movingPiece.letter&&whitesMove&&(print("whiteMove: C move fm:",
tempx,tempy),print("whiteMove: C move to:",a,b)),"K"!=movingPiece.letter||whitesMove||(print("blackMove: X move fm:",tempx,tempy),print("blackMove: X move to:",a,b)),"R"!=movingPiece.letter||whitesMove||(print("blackMove: Y move fm:",tempx,tempy),print("blackMove: Y move to:",a,b)),"P"!=movingPiece.letter||whitesMove||(print("blackMove: Z move fm:",tempx,tempy),print("blackMove: Z move to:",a,b)),movingPiece.movingThisPiece=!1,whitesMove=!whitesMove):movingPiece.movingThisPiece=!1;else if(movingPiece=
test.getPieceAt(a,b),null!=movingPiece&&movingPiece.white==whitesMove)movingPiece.movingThisPiece=!0,tempx=a,tempy=b;else return;moving=!moving}}function htmlStuff(){createP("");depthPara=createDiv("Thinking "+maxDepth+" moves ahead");depthMinus=createButton("-");depthPlus=createButton("+");depthPlus.mousePressed(plusDepth);depthMinus.mousePressed(minusDepth)}function minusDepth(){1<tempMaxDepth&&(--tempMaxDepth,depthPara.html("Thinking "+tempMaxDepth+" moves ahead"))}
function plusDepth(){10>tempMaxDepth&&(tempMaxDepth+=1,depthPara.html("Thinking "+tempMaxDepth+" moves ahead"))};